---
title: "CODA para estudios del microbioma"
subtitle: "Seminario para METACIRCLE"
author: "Grupo BIOCOM"
date: "8 Junio 2023"
institute: "Dpto. Matem谩ticas e Inform谩tica - UIB"
format: sketchy-html
toc: true
---

## Introducci贸n 

-   Los conjuntos de datos recogidos mediante secuenciaci贸n de alto rendimiento (HTS) pueden ser analizados a partir de conteos absolutos o normalizados, si el prop贸sito es hacer estad铆stica descriptiva (no siempre coinciden).

-   Si el prop贸sito es hacer inferencia estad铆stica, se debe usar CODA (Compositional Data Analysis).

### Objetivos del seminario 

1.- Discutiremos las diferencias entre trabajar con conteos absolutos (abundancias absolutas) y conteos normalizados (abundancias relativas).

2.- Indicaremos los principios de CODA.

3.- Mostraremos el `tool kit` de CODA de microbioma.

4.- `CODA en acci贸n`: ejemplo de an谩lisis de datos composicionales.


## 2. Principios b谩sicos del CODA

-   Cada muestra se considera como un vector de datos composicionales $(x_1, \ldots, x_k)$ con cada $x_i \geq 0$.

-   Consideramos que dos vectores son equivalentes cuando son proporcionales.

-   El an谩lisis de los datos se basa en las ratios $x_i/x_j$.

-   Las ratios se transforman mediante logaritmos para traducir comparaci贸n relativa en comparaci贸n absoluta (y para acercar las ratios a una normal).

[Estas transformaciones producen los mismos resultados si los conteos son absolutos o proporciones]{.highlight}.

<center>![](images/coda2.PNG)</center>

<br>

<center>![](images/coda3.PNG)</center>

<br>

<font color="blue"> Los cocientes logar铆tmicos son n煤meros reales, una gran ventaja para la aplicaci贸n de los m茅todos estad铆sticos est谩ndar desarrollados para variables aleatorias continuas.</font>

A menudo se utiliza la transformaci贸n log-ratio centrada (clr) introducida Aitchison (1986).

Dado un vector $\mathbf{x}$ de conteos de OTUs, $\mathbf{x}=(x_1, \ldots,x_D)$, su transformaci贸n **clr** es:

$$\mathbf{x}_{clr}= \left( \log(x_1/g(\mathbf{x})),\ldots, \log(x_D/g(\mathbf{x}))\right),$$

donde $g(\mathbf{x})$ es la media geom茅trica de $\mathbf{x}$, es decir, $g(\mathbf{x})=\sqrt[D]{x_1 \cdot x_2 \cdots x_D}$.

**Tratamiento de los ceros:**

-   Si alguna variable es cero, no se pueden calcular las ratios.

-   Imputaci贸n de ceros: `zCompositions` de R, como una distribuci贸n de probabilidad utilizando `ALDEx2` disponible en Bioconductor.

### <font color="red"> Metodolog铆a </font>

::: box
<center>![](images/proceso.PNG)</center>
:::

## 3. Reemplazos composicionales del `tool kit` tradicional 

<br>

<center>![](images/tabla_1.PNG)</center>

<br>

**Distancia de Aitchison**

-   La distancia de Aitchison no es m谩s que la distancia euclidiana entre muestras despu茅s de transformaci贸n clr.

<center>![](images/dA.PNG)</center>

<br>

**Correlaciones de datos composicionales**

Existen varias t茅cnicas para analizar la correlaci贸n de los datos del microbioma que suelen ser matrices "sparce". Uno de ellos es `r-sparc`.

## 4. CODA en acci贸n 

<br>

<center>![](https://www.taiwisdom.org/artclnchdev/copy_of_timeout.gif){width="40%"}</center>
